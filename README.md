# 🧪 iGEM 알지네이트 필름 분석 앱

알지네이트 필름의 색 변화를 분석하여 **CuSO₄(황산구리) 중금속 농도**를 추정하는 모바일 앱입니다.

---

## 📱 앱 기능 요약

| 기능                   | 설명                                                       |
| ---------------------- | ---------------------------------------------------------- |
| 📸 사진 촬영 / 업로드  | 카메라로 필름을 촬영하거나 갤러리에서 사진을 선택          |
| 🔴 빨간 영역 자동 감지 | 사진에서 가장 빨간 부분을 찾아 반응 영역을 자동으로 잡아줌 |
| ✏️ 수동 영역 조정      | 점을 드래그하거나, 선 위를 탭하여 점을 추가/삭제           |
| 🧮 농도 자동 계산      | 반응 면적 → 면적 증가율 → CuSO₄ 농도(%) 공식 적용          |
| 📊 결과 저장 & 기록    | 분석 결과가 자동 저장되며 홈 화면에서 기록 확인 가능       |
| 🗑️ 기록 삭제           | 홈 화면에서 전체 기록 일괄 삭제                            |

---

## 🚀 사용 방법 (단계별 가이드)

### 1단계: 측정 설정

앱을 실행하면 홈 화면이 나타납니다. **"분석 시작"** 버튼을 누르세요.

다음 화면에서 두 가지를 설정합니다:

- **기준 방식 선택**
  - `페트리 접시`: 사진에 페트리 접시가 함께 찍힌 경우 (기본 150mm)
  - `눈금자`: 사진에 눈금자가 함께 찍힌 경우 (기본 50mm)
- **필름 지름 입력**: 분석할 필름의 실제 지름을 mm 단위로 입력합니다 (기본 25mm)

> 💡 기준 물체(페트리 접시 또는 눈금자)는 실제 크기를 앱에 알려주는 역할을 합니다.

### 2단계: 사진 촬영 또는 업로드

설정 후 카메라 화면으로 이동합니다.

- **촬영**: 하단 중앙의 촬영 버튼을 누르세요
- **갤러리에서 선택**: 좌측 하단의 업로드 아이콘을 누르세요

> ⚠️ 촬영 시 **기준 물체(페트리 접시 또는 눈금자)**와 **필름**이 모두 사진 안에 들어오도록 찍어주세요.

### 3단계: 기준 물체 설정

촬영 후 분석 화면으로 이동합니다.

사진 위에 **파란색 원(또는 선)**이 보입니다. 이것을 기준 물체에 맞게 조절하세요:

- **페트리 모드**: 파란 원을 페트리 접시에 맞춤
- **눈금자 모드**: 파란 선을 눈금자에 맞춤

> 이 과정이 정확해야 면적 계산도 정확해집니다!

### 4단계: 반응 영역 설정

빨간색으로 변한 반응 영역을 설정하는 방법은 **두 가지**입니다:

#### 방법 A: 자동 감지 (추천 ✨)

상단의 **🔍 자동 감지** 버튼을 누르면:

1. 앱이 사진에서 가장 빨간 색상을 찾습니다
2. 비슷한 색상의 픽셀들을 모아서 가장 큰 영역을 선택합니다
3. 원형에 가까운 다각형으로 영역을 자동 설정합니다

> 여러 필름이 사진에 있어도 **가장 큰 반응 영역 하나만** 인식합니다.

#### 방법 B: 수동 설정

사진 위에서 반응 영역의 경계를 따라 탭하여 점을 찍습니다:

1. 경계를 따라 여러 점을 탭합니다
2. **첫 번째 점을 다시 탭**하면 다각형이 닫힙니다

### 5단계: 영역 세밀 조정

자동이든 수동이든, 설정 후 세밀하게 조정할 수 있습니다:

| 동작      | 방법                                               |
| --------- | -------------------------------------------------- |
| 점 이동   | 점을 **길게 누르고 드래그**                        |
| 점 삭제   | 점을 **짧게 탭** (3개 이상 남아있으면 다각형 유지) |
| 점 추가   | 다각형의 **선(변) 위를 탭** → 그 위치에 새 점 추가 |
| 전체 삭제 | 상단 **🗑️ 버튼** → 영역 초기화                     |

### 6단계: 결과 확인

하단 결과 패널에서 실시간으로 다음 정보를 확인할 수 있습니다:

- **CuSO₄ 추정 농도 (%)**: 계산된 중금속 농도
- **면적 증가율 (%)**: 반응 면적 / 필름 면적 × 100
- **반응 면적 (mm²)**: 빨간 영역의 실제 면적
- **필름 지름 (mm)**: 입력한 필름 크기
- **기준 크기 (mm)**: 페트리/눈금자 크기

**"결과 저장하기"** 버튼을 누르면 결과가 저장되고 상세 결과 화면으로 이동합니다.

---

## 🧮 계산 공식

> **Area increase (%) = a(C) × T² + b(C) × T + c(C)**

여기서:

- **C** = CuSO₄ 농도 (%)
- **T** = 필름 두께 (mm) — 앱에서는 **1.0mm**로 고정
- **Area increase (%)** = (반응 면적 / 원래 필름 면적) × 100

### CuSO₄ 계수

| 계수 | 식                      |
| ---- | ----------------------- |
| a(C) | 35190 × ln(C) − 96479   |
| b(C) | 2037.8 × ln(C) + 5645.6 |
| c(C) | −31.43 × ln(C) − 86.72  |

### 농도 역산 방법

위 식을 `ln(C)` 기준으로 정리하면:

```
ln(C) = (AreaIncrease + 96479×T² − 5645.6×T + 86.72) / (35190×T² + 2037.8×T − 31.43)
C = e^(ln(C))
```

---

## 📋 기록 관리

홈 화면 하단에서 과거 분석 기록을 확인할 수 있습니다:

- 각 기록에는 **날짜, 농도(%), 반응 면적(mm²)** 이 표시됩니다
- 전체 기록을 삭제하려면 **🗑️ 기록 삭제** 버튼을 누르세요

---

## 🛠 설치 방법

### 필요 프로그램

| 프로그램      | 용도              | 설치 링크                                    |
| ------------- | ----------------- | -------------------------------------------- |
| Node.js (LTS) | 앱 실행 환경      | [nodejs.org](https://nodejs.org/ko/)         |
| Git           | 소스코드 다운로드 | [git-scm.com](https://git-scm.com/downloads) |
| Expo Go       | 폰에서 앱 실행    | App Store / Play Store                       |

### 설치 순서

```bash
# 1. 소스코드 다운로드
git clone https://github.com/hhhkdev/igem-alginate-film-mobile.git

# 2. 폴더 이동
cd igem-alginate-film-mobile

# 3. 필요 라이브러리 설치
npm install

# 4. 앱 실행
npx expo start
```

화면에 **QR 코드**가 나타나면:

- **iPhone**: 기본 카메라 앱으로 QR 스캔 → "Expo Go에서 열기"
- **Android**: Expo Go 앱에서 "Scan QR Code"

> ⚠️ 컴퓨터와 휴대폰이 **같은 Wi-Fi**에 연결되어 있어야 합니다.

---

## ❓ 자주 묻는 질문

**Q. QR 코드를 찍었는데 앱이 안 열려요.**
→ 같은 Wi-Fi인지 확인하세요. 안 되면 `npx expo start --tunnel` 으로 시도해보세요.

**Q. 카메라 권한이 안 떠요.**
→ 휴대폰 설정 > Expo Go > 권한 > 카메라 허용으로 직접 설정해주세요.

**Q. 자동 감지가 영역을 못 찾아요.**
→ 반응이 매우 연하면 인식이 어려울 수 있습니다. 수동으로 점을 찍어 영역을 설정해주세요.

**Q. 여러 필름이 사진에 있어요.**
→ 자동 감지는 가장 큰 반응 영역만 인식합니다. 필름별로 따로 촬영하는 것을 권장합니다.

---

이 가이드에 대해 추가 질문이 있다면 개발팀에게 문의해주세요! 🙌
